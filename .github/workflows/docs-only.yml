name: docs-only

on:
  pull_request:
    paths:
      - 'docs/**'
      - 'mkdocs.yml'
      - 'makefiles/docs.mk'
      - 'docs/contracts/**/*.json'
      - 'docs/_generated/openapi/**'
      - 'configs/openapi/v1/openapi.generated.json'

permissions:
  contents: read

jobs:
  docs-check:
    runs-on: ubuntu-latest
    env:
      ISO_ROOT: artifacts/isolates/docs-only
      CARGO_TARGET_DIR: artifacts/isolates/docs-only/target
      CARGO_HOME: artifacts/isolates/docs-only/cargo-home
      TMPDIR: artifacts/isolates/docs-only/tmp
      TMP: artifacts/isolates/docs-only/tmp
      TEMP: artifacts/isolates/docs-only/tmp
    steps:
      - uses: actions/checkout@v4
      - run: ./bin/atlasctl ci init --json
      - run: make docs
      - uses: actions/upload-artifact@v4
        with:
          name: docs-site-pr
          path: artifacts/docs/site
