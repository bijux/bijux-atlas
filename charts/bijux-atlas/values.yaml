image:
  repository: ghcr.io/bijux/bijux-atlas
  tag: latest
  pullPolicy: IfNotPresent

replicaCount: 2

service:
  type: ClusterIP
  port: 8080

resources:
  requests:
    cpu: "500m"
    memory: "512Mi"
    ephemeral-storage: "2Gi"
  limits:
    cpu: "2000m"
    memory: "2Gi"
    ephemeral-storage: "10Gi"

podSecurityContext:
  runAsNonRoot: true
  runAsUser: 65532
  runAsGroup: 65532
  fsGroup: 65532

securityContext:
  readOnlyRootFilesystem: true
  allowPrivilegeEscalation: false
  capabilities:
    drop: ["ALL"]

cache:
  diskSize: 8Gi
  tmpSize: 512Mi
  maxDatasetCount: 8
  maxDiskBytes: 8589934592
  pinnedDatasets: []
  warmupEnabled: false
  warmupFailReadinessOnMissing: false
  startupWarmupJitterMaxMs: 30000
  maxConcurrentDownloads: 3
  initPrewarm:
    enabled: false
    image: ghcr.io/bijux/bijux-atlas:latest

rateLimits:
  perIp:
    capacity: 30
    refillPerSec: 10
  perApiKey:
    enabled: false
    capacity: 100
    refillPerSec: 30

concurrency:
  cheap: 128
  medium: 64
  heavy: 16

server:
  command:
    - /app/bijux-atlas
    - atlas
    - serve
  requestTimeoutMs: 5000
  sqlTimeoutMs: 800
  responseMaxBytes: 524288
  maxBodyBytes: 16384
  slowQueryThresholdMs: 200
  enableDebugDatasets: false
  enableExemplars: false
  cachedOnlyMode: false
  readOnlyFsMode: false
  shutdownDrainMs: 5000
  readinessRequiresCatalog: true

catalog:
  endpoint: ""
  etagEnabled: true

store:
  endpoint: ""
  s3PresignedBaseUrl: ""
  credentialsSecretName: ""

networkPolicy:
  enabled: true
  allowDns: true
  allowedEgressCIDRs: []

serviceMonitor:
  enabled: true
  interval: 15s
  scrapeTimeout: 5s
  labels: {}

hpa:
  enabled: true
  minReplicas: 2
  maxReplicas: 20
  cpuUtilization: 70
  p95LatencySeconds: "0.300"
  heavyInflightAverageValue: "8"
  behavior:
    scaleUp:
      stabilizationWindowSeconds: 0
      policies:
        - type: Percent
          value: 100
          periodSeconds: 30
    scaleDown:
      stabilizationWindowSeconds: 120
      policies:
        - type: Percent
          value: 20
          periodSeconds: 60

pdb:
  enabled: true
  minAvailable: 1
  maxUnavailable: null

priorityClassName: ""

terminationGracePeriodSeconds: 30

nodeLocalSsdProfile:
  enabled: false
  note: "Prefer node-local SSD for /cache and benchmark p95 gains before rollout."

rollout:
  enabled: false
  steps:
    - setWeight: 10
    - pause:
        duration: 60s
    - setWeight: 50
    - pause:
        duration: 120s

catalogPublishJob:
  enabled: false
  backoffLimit: 1
  image: ghcr.io/bijux/bijux-atlas:latest
  command:
    - /app/atlas-cli
    - ingest

extraEnv: []

nodeSelector: {}
tolerations: []
affinity: {}
